!function(){"use strict";const e={init:function(){this.sanitizeInputs(),this.preventXSS(),this.secureExternalLinks(),this.validateForms()},sanitizeInputs:function(){document.querySelectorAll('input[type="text"], input[type="email"], textarea').forEach(e=>{e.addEventListener("input",function(e){let t=e.target.value;t=t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""),t=t.replace(/javascript:/gi,""),t=t.replace(/on\w+\s*=/gi,""),t!==e.target.value&&(e.target.value=t)})})},preventXSS:function(){window.escapeHtml=function(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}},secureExternalLinks:function(){document.querySelectorAll('a[href^="http"]:not([href*="'+window.location.hostname+'"])').forEach(e=>{e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank")})},validateForms:function(){document.querySelectorAll("form").forEach(t=>{t.addEventListener("submit",function(r){if(!e.validateForm(t))return r.preventDefault(),!1})})},validateForm:function(e){let t=!0;return e.querySelectorAll("input[required], textarea[required]").forEach(e=>{const r=e.value.trim();if(!r)return this.showFieldError(e,"This field is required"),void(t=!1);if("email"===e.type){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r))return this.showFieldError(e,"Please enter a valid email address"),void(t=!1)}if("tel"===e.type){if(!/^[\+]?[1-9][\d]{0,15}$/.test(r.replace(/\s/g,"")))return this.showFieldError(e,"Please enter a valid phone number"),void(t=!1)}this.clearFieldError(e)}),t},showFieldError:function(e,t){this.clearFieldError(e);const r=document.createElement("div");r.className="field-error",r.textContent=t,r.style.cssText="color: #dc3545; font-size: 12px; margin-top: 4px;",e.parentNode.appendChild(r),e.style.borderColor="#dc3545"},clearFieldError:function(e){const t=e.parentNode.querySelector(".field-error");t&&t.remove(),e.style.borderColor=""},rateLimitSubmission:function(e){const t=localStorage.getItem("lastFormSubmission"),r=Date.now();return!(t&&r-parseInt(t)<5e3)&&(localStorage.setItem("lastFormSubmission",r.toString()),!0)}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){e.init()}):e.init(),window.Security=e}();